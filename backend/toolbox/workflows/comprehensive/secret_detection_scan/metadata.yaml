name: secret_detection_scan
version: "2.0.0"
description: "Comprehensive secret detection using TruffleHog and Gitleaks"
author: "FuzzForge Team"
category: "comprehensive"
tags:
  - "secrets"
  - "credentials"
  - "detection"
  - "trufflehog"
  - "gitleaks"
  - "comprehensive"

supported_volume_modes:
  - "ro"
  - "rw"

default_volume_mode: "ro"
default_target_path: "/workspace"

requirements:
  tools:
    - "trufflehog"
    - "gitleaks"
  resources:
    memory: "512Mi"
    cpu: "500m"
    timeout: 1800

has_docker: true

default_parameters:
  target_path: "/workspace"
  volume_mode: "ro"
  trufflehog_config: {}
  gitleaks_config: {}
  reporter_config: {}

parameters:
  type: object
  properties:
    target_path:
      type: string
      default: "/workspace"
      description: "Path to analyze"
    volume_mode:
      type: string
      enum: ["ro", "rw"]
      default: "ro"
      description: "Volume mount mode"
    trufflehog_config:
      type: object
      description: "TruffleHog configuration"
      properties:
        verify:
          type: boolean
          description: "Verify discovered secrets"
        concurrency:
          type: integer
          description: "Number of concurrent workers"
        max_depth:
          type: integer
          description: "Maximum directory depth to scan"
        include_detectors:
          type: array
          items:
            type: string
          description: "Specific detectors to include"
        exclude_detectors:
          type: array
          items:
            type: string
          description: "Specific detectors to exclude"
    gitleaks_config:
      type: object
      description: "Gitleaks configuration"
      properties:
        scan_mode:
          type: string
          enum: ["detect", "protect"]
          description: "Scan mode"
        redact:
          type: boolean
          description: "Redact secrets in output"
        max_target_megabytes:
          type: integer
          description: "Maximum file size to scan (MB)"
        no_git:
          type: boolean
          description: "Scan files without Git context"
        config_file:
          type: string
          description: "Path to custom configuration file"
        baseline_file:
          type: string
          description: "Path to baseline file"
    reporter_config:
      type: object
      description: "SARIF reporter configuration"
      properties:
        output_file:
          type: string
          description: "Output SARIF file name"
        include_code_flows:
          type: boolean
          description: "Include code flow information"

output_schema:
  type: object
  properties:
    sarif:
      type: object
      description: "SARIF-formatted security findings"
